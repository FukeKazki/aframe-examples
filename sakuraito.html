<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>boxcraft for Oculus Quest - A-Frame</title>
	<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
</head>
<body>
<script>
window.onload = function() {
	const scene = document.querySelector('a-scene')
  const button = document.querySelector('#button')
	// const list = []

	handright.addEventListener('triggerdown', function(evt) {
    const box = document.createElement('a-box')
    box.setAttribute('mixin', 'voxel')
    box.setAttribute('animation', {
      'property': 'position',
      'to': {x: 1, y: 1, z: 1}
    })
		const p = handright.getAttribute('position')
		const snap = 0.1
		let p2 = {
			x: Math.floor(p.x / snap) * snap + snap / 2,
			y: Math.floor(p.y / snap) * snap + snap / 2,
			z: Math.floor(p.z / snap) * snap + snap / 2,
		}
	// 	let box = document.createElement('a-box')
		box.setAttribute('position', p2)
    box.setAttribute('geometry', "primitive: box; height: 0.2; width: 0.2; depth: 0.2")
	// 	box.setAttribute('mixin', 'voxel')
		scene.appendChild(box)
	// 	list.push(box)
	})

  //   handleft.addEventListener('triggerdown', function(evt) {
	// 	const p = handleft.getAttribute('position')
	// 	const snap = 0.1
	// 	let p2 = {
	// 		x: Math.floor(p.x / snap) * snap + snap / 2,
	// 		y: Math.floor(p.y / snap) * snap + snap / 2,
	// 		z: Math.floor(p.z / snap) * snap + snap / 2,
	// 	}
	// 	let box = document.createElement('a-box')
  //       box.setAttribute('geometry', "primitive: box; height: 0.2; width: 0.2; depth: 0.2")
	// 	box.setAttribute('position', p2)
	// 	box.setAttribute('mixin', 'voxel')
	// 	scene.appendChild(box)
	// 	list.push(box)
	// })

	// handright.addEventListener('gripdown', function(evt) {
	// 	const b = list.pop()
	// 	if (b)
	// 		scene.removeChild(b)
	// })

  //   // Bボタンを押したとき
	// handright.addEventListener('bbuttondown', function(evt) {
	// 	const boxes = scene.querySelectorAll('a-box')
	// 	for (let i = 0; i < boxes.length; i++)
	// 		scene.removeChild(boxes[i])
	// })

  //   // Xボタンを押したとき
  //   handleft.addEventListener('xbuttondown', function(evt) {
  //       const box = list.pop();
  //       box.setAttribute('color', generateColorCode());
  //       list.push(box);
  //   })
}
</script>
<a-scene id="scene" background="color: #000">
    <!-- コンポーネントの定義 -->
	<a-assets>
    <a-mixin
      id="voxel"
      geometry="primitive: box; height: 0.1; width: 0.1; depth: 0.1"
      material="shader: standard"
      animation="property: rotation; to: 0 360 0; loop: true; dur: 10000"
      >
    </a-mixin>
	</a-assets>

    <!-- テキスト -->
    <a-entity position="0 1 -1">
        <a-text value="MetaCraft" id="button"></a-text>
    </a-entity>

    <!-- hit-test -->
    <!-- <a-scene webxr="optionalFeatures:  hit-test;" ar-hit-test="target:#myobject;">
    <a-entity id="myobject"></a-entity> -->

    <!-- コントローラー -->
	<a-entity id=handleft hand-controls="hand: left;  handModelStyle: lowPoly; color: #ffcccc">
        <a-text value="ぽえー"></a-text>
    </a-entity>
	<a-entity id=handright hand-controls="hand: right; handModelStyle: lowPoly; color: #ffcccc" laser-controls raycaster="showLine: true; far: .05" line="color: white; opacity: 0.75;"></a-entity>

  <!-- light -->
  <a-entity id="light" light="color: #c9e208; intensity: 1.2; type: point"></a-entity>

  <!-- box -->
  <a-entity geometry=""></a-entity>

  <!-- 地面ほしい -->
  <!-- ライブ会場ステージみたいな設備ほしい、3dオブジェクト配置しないと距離感つかめない -->
</a-scene>
</body>
</html>